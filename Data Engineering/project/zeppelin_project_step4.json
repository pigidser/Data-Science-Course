{"paragraphs":[{"text":"%md\n## Load data to RAW folder and move to STAGE folder with transform if needed","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:50:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594720736097_-1823720562","id":"20200714-095856_572728744","dateCreated":"2020-07-14T09:58:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5307","dateFinished":"2020-07-14T10:50:45+0000","dateStarted":"2020-07-14T10:50:45+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Load data to RAW folder and move to STAGE folder with transform if needed</h2>\n</div>"}]}},{"text":"%sh\nrm -r -f /tmp/pigidser_raw\nrm -r -f /tmp/pigidser_stage\nmkdir /tmp/pigidser_raw\nmkdir /tmp/pigidser_stage\ncd /home/deng/Data/\ncp *.json /tmp/pigidser_raw\ncp countries_of_the_world.csv nobel-laureates.csv /tmp/pigidser_raw\nls /tmp/pigidser_raw\n","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:01:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594720598363_1456401350","id":"20200714-095638_860412844","dateCreated":"2020-07-14T09:56:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5219","dateFinished":"2020-07-14T10:01:39+0000","dateStarted":"2020-07-14T10:01:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"capital.json\ncontinent.json\ncountries_of_the_world.csv\ncurrency.json\niso3.json\nnames.json\nnobel-laureates.csv\nphone.json\n"}]}},{"text":"%python\n# transform json-files (capital, continent, currency, iso3, names, phone) to csv\n\nimport json\n# import csv\n# import subprocess\n\ndef transform_json_to_csv(file_name):\n    with open(\"/tmp/pigidser_raw/\"+file_name+\".json\",\"r\") as fp:\n        buf = fp.read()\n    data_dict = json.loads(buf)\n    \n    with open(\"/tmp/pigidser_stage/\"+file_name+\".csv\", 'w') as f:\n        for key in data_dict.keys():\n            f.write(\"%s,%s\\n\"%(key,data_dict[key]))\n\nfiles_to_process = ['capital','continent','currency','iso3','names', 'phone']\nfor file in files_to_process:\n    transform_json_to_csv(file)","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:51:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594720950952_875585973","id":"20200714-100230_1358892019","dateCreated":"2020-07-14T10:02:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5724","dateFinished":"2020-07-14T10:03:14+0000","dateStarted":"2020-07-14T10:03:14+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%python\n# countries_of_the_world.csv consists of comma in number as well as delimited character --> replace a comma with a point\n# also to remove multy-spaces\n\nimport re\n\nwith open(\"/tmp/pigidser_raw/countries_of_the_world.csv\",\"r\") as f_input:\n    with open('/tmp/pigidser_stage/countries_of_the_world.csv', 'w') as f_output:\n        for result in f_input:\n            result = re.sub(r'\"(\\d+),(\\d+)\"', r'\\1.\\2', result) # find a comma between digits in quotes and replace to a point\n            result = re.sub(r'\\s+', r' ', result) # replace multi-space to single space\n            result = re.sub(r'\\s,', r',', result)\n            result = re.sub(r'\\s+\",', r'\",', result)\n            result = re.sub(r'\"\\s+', r'\"', result)\n            f_output.write(result+\"\\n\")\nf_input.close\nf_output.close\n\nwith open(\"/tmp/pigidser_raw/nobel-laureates.csv\",\"r\") as f_input:\n    with open('/tmp/pigidser_stage/nobel-laureates.csv', 'w') as f_output:\n        for result in f_input:\n            result = re.sub(r'[\\\"]+','\"',result)\n            result = re.sub(r'\\s+', r' ', result)\n            result = re.sub(r'\\s,', r',', result)\n            f_output.write(result+\"\\n\")\nf_input.close\nf_output.close","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:07:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721012165_683947254","id":"20200714-100332_275836713","dateCreated":"2020-07-14T10:03:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5812","dateFinished":"2020-07-14T10:07:00+0000","dateStarted":"2020-07-14T10:07:00+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<built-in method close of _io.TextIOWrapper object at 0x7f4225166c18>\n"}]}},{"text":"%sh\nls /tmp/pigidser_stage","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:52:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594722394630_-2115502253","id":"20200714-102634_1490855157","dateCreated":"2020-07-14T10:26:34+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7584","dateFinished":"2020-07-14T10:52:02+0000","dateStarted":"2020-07-14T10:52:02+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"ls: cannot access /tmp/pigidser_stage: No such file or directory\n"},{"type":"TEXT","data":"ExitValue: 2"}]}},{"text":"%sh\nhdfs dfs -rm -r -f -skipTrash pigidser_datamart\nhdfs dfs -mkdir pigidser_datamart\ncd /tmp/pigidser_stage\nhdfs dfs -put *.*  pigidser_datamart","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:52:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594722603443_1381573832","id":"20200714-103003_2016404777","dateCreated":"2020-07-14T10:30:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7716","dateFinished":"2020-07-14T10:33:57+0000","dateStarted":"2020-07-14T10:33:50+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nDeleted pigidser_datamart\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\n"}]}},{"text":"%md\n## Load data to Spark","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:26:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594722359404_1551151183","id":"20200714-102559_184805174","dateCreated":"2020-07-14T10:25:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7494","dateFinished":"2020-07-14T10:26:20+0000","dateStarted":"2020-07-14T10:26:20+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Load data to Spark</h2>\n</div>"}]}},{"text":"%spark.pyspark\ncapital = spark.read.csv(\"pigidser_datamart/capital.csv\",schema=\"code string, capital string\",header=False)\ncontinent = spark.read.csv(\"pigidser_datamart/continent.csv\",schema=\"code string, continent string\",header=False)\ncurrency = spark.read.csv(\"pigidser_datamart/currency.csv\",schema=\"code string, currency string\",header=False)\niso3 = spark.read.csv(\"pigidser_datamart/iso3.csv\",schema=\"code string, iso3 string\",header=False)\nnames = spark.read.csv(\"pigidser_datamart/names.csv\",schema=\"code string, name string\",header=False)\nphone = spark.read.csv(\"pigidser_datamart/phone.csv\",schema=\"code string, phone string\",header=False)\ncountries = spark.read.csv(\"pigidser_datamart/countries_of_the_world.csv\",header=True)\nlaureates = spark.read.csv(\"pigidser_datamart/nobel-laureates.csv\",header=True)\n# worldcitiespop = spark.read.csv(\"data/stage/worldcitiespop.csv\",header=True)","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:44:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721261424_-1866976335","id":"20200714-100741_400956435","dateCreated":"2020-07-14T10:07:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5964","dateFinished":"2020-07-14T10:44:14+0000","dateStarted":"2020-07-14T10:44:14+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://adh-client:4041/jobs/job?id=32","http://adh-client:4041/jobs/job?id=33"],"interpreterSettingId":"spark"}}},{"text":"%spark.pyspark\nimport re\n\ndef standartize_column_name(rename_df):\n    for column in rename_df.columns:\n        new_column = re.sub(r'[\\.\\s\\(\\)\\/\\$\\%]+','_',column.lower().strip())\n        new_column = re.sub(r'[\\_]+','_',new_column)\n        new_column = re.sub(r'(\\S+)_\\b', r'\\1', new_column) # if name like abcdefgh_ remove \"_\"\n        rename_df = rename_df.withColumnRenamed(column, new_column)\n    return rename_df\n\ncountries = standartize_column_name(countries)\nlaureates = standartize_column_name(laureates)\n# worldcitiespop = standartize_column_name(worldcitiespop)","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:44:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721401569_2001476900","id":"20200714-101001_970517167","dateCreated":"2020-07-14T10:10:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6783","dateFinished":"2020-07-14T10:44:18+0000","dateStarted":"2020-07-14T10:44:18+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%md\n## Data Mart preparation","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:11:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721468192_2138219077","id":"20200714-101108_268282118","dateCreated":"2020-07-14T10:11:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6999","dateFinished":"2020-07-14T10:11:25+0000","dateStarted":"2020-07-14T10:11:21+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Data Mart preparation</h2>\n</div>"}]}},{"text":"%spark.pyspark\n# joining by a key field (with the same name) to get only one key field in the result dataframe\ncountry_properties = capital.join(continent, 'code')\\\n    .join(currency, 'code')\\\n    .join(iso3, 'code')\\\n    .join(names, 'code')\\\n    .join(phone, 'code')\n\ncountries = countries\\\n    .join(country_properties.select('code','capital','continent','currency','iso3','name','phone'),countries['country']==country_properties['name'],'left')\\\n    .drop(\"name\",\"capital\")\n\nnobel_laureates = laureates.select('laureate_id','category','laureate_type','full_name','birth_date',\n    'birth_city','birth_country','sex','organization_name','organization_city','organization_country',\n    'death_date','death_city','death_country')\n\nnobel_prizes = laureates.select(\"year\",\"prize\",\"motivation\",\"prize_share\",\"laureate_id\")\n\n# cities = worldcitiespop.drop(\"region\")\n\nnobel_prizes.show(1)\nnobel_laureates.show(1)\ncountries.show(1)\n# cities.show(1)","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:44:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721428271_171207081","id":"20200714-101028_1251826081","dateCreated":"2020-07-14T10:10:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6927","dateFinished":"2020-07-14T10:44:26+0000","dateStarted":"2020-07-14T10:44:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+--------------------+--------------------+-----------+-----------+\n|year|               prize|          motivation|prize_share|laureate_id|\n+----+--------------------+--------------------+-----------+-----------+\n|1901|The Nobel Prize i...|in recognition of...|        1/1|        160|\n+----+--------------------+--------------------+-----------+-----------+\nonly showing top 1 row\n\n+-----------+---------+-------------+--------------------+----------+----------+-------------+----+-----------------+-----------------+--------------------+----------+----------+-------------+\n|laureate_id| category|laureate_type|           full_name|birth_date|birth_city|birth_country| sex|organization_name|organization_city|organization_country|death_date|death_city|death_country|\n+-----------+---------+-------------+--------------------+----------+----------+-------------+----+-----------------+-----------------+--------------------+----------+----------+-------------+\n|        160|Chemistry|   Individual|Jacobus Henricus ...|1852-08-30| Rotterdam|  Netherlands|Male|Berlin University|           Berlin|             Germany|1911-03-01|    Berlin|     Germany |\n+-----------+---------+-------------+--------------------+----------+----------+-------------+----+-----------------+-----------------+--------------------+----------+----------+-------------+\nonly showing top 1 row\n\n+-------+------------------+----------+----------+---------------------+--------------------------+-------------+--------------------------------+--------------+--------+---------------+------+-----+-----+-------+---------+---------+-----------+--------+-------+----+---------+--------+----+-----+\n|country|            region|population|area_sq_mi|pop_density_per_sq_mi|coastline_coast_area_ratio|net_migration|infant_mortality_per_1000_births|gdp_per_capita|literacy|phones_per_1000|arable|crops|other|climate|birthrate|deathrate|agriculture|industry|service|code|continent|currency|iso3|phone|\n+-------+------------------+----------+----------+---------------------+--------------------------+-------------+--------------------------------+--------------+--------+---------------+------+-----+-----+-------+---------+---------+-----------+--------+-------+----+---------+--------+----+-----+\n|   Chad|SUB-SAHARAN AFRICA|   9944201|   1284000|                  7.7|                      0.00|        -0,11|                           93.82|          1200|    47.5|            1.3|  2.86| 0.02|97.12|      2|    45.73|    16.38|      0.335|   0.259| 0.406 |  TD|       AF|     XAF| TCD|  235|\n+-------+------------------+----------+----------+---------------------+--------------------------+-------------+--------------------------------+--------------+--------+---------------+------+-----+-----+-------+---------+---------+-----------+--------+-------+----+---------+--------+----+-----+\nonly showing top 1 row\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://adh-client:4041/jobs/job?id=34","http://adh-client:4041/jobs/job?id=35","http://adh-client:4041/jobs/job?id=36","http://adh-client:4041/jobs/job?id=37","http://adh-client:4041/jobs/job?id=38","http://adh-client:4041/jobs/job?id=39","http://adh-client:4041/jobs/job?id=40","http://adh-client:4041/jobs/job?id=41","http://adh-client:4041/jobs/job?id=42"],"interpreterSettingId":"spark"}}},{"text":"%md\n## Dataset preparation","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:12:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721540941_1221704630","id":"20200714-101220_1291362247","dateCreated":"2020-07-14T10:12:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7170","dateFinished":"2020-07-14T10:12:40+0000","dateStarted":"2020-07-14T10:12:40+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Dataset preparation</h2>\n</div>"}]}},{"text":"%spark.pyspark\nnobel_prizes_dataset = nobel_prizes.join(nobel_laureates, 'laureate_id')\ncountries_dataset = countries\n\nnobel_prizes_dataset.show(1)\ncountries_dataset.show(1)","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:44:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721538660_900480393","id":"20200714-101218_1218646574","dateCreated":"2020-07-14T10:12:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7098","dateFinished":"2020-07-14T10:44:33+0000","dateStarted":"2020-07-14T10:44:32+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----+--------------------+--------------------+-----------+---------+-------------+--------------------+----------+----------+-------------+----+-----------------+-----------------+--------------------+----------+----------+-------------+\n|laureate_id|year|               prize|          motivation|prize_share| category|laureate_type|           full_name|birth_date|birth_city|birth_country| sex|organization_name|organization_city|organization_country|death_date|death_city|death_country|\n+-----------+----+--------------------+--------------------+-----------+---------+-------------+--------------------+----------+----------+-------------+----+-----------------+-----------------+--------------------+----------+----------+-------------+\n|        160|1901|The Nobel Prize i...|in recognition of...|        1/1|Chemistry|   Individual|Jacobus Henricus ...|1852-08-30| Rotterdam|  Netherlands|Male|Berlin University|           Berlin|             Germany|1911-03-01|    Berlin|     Germany |\n+-----------+----+--------------------+--------------------+-----------+---------+-------------+--------------------+----------+----------+-------------+----+-----------------+-----------------+--------------------+----------+----------+-------------+\nonly showing top 1 row\n\n+-------+------------------+----------+----------+---------------------+--------------------------+-------------+--------------------------------+--------------+--------+---------------+------+-----+-----+-------+---------+---------+-----------+--------+-------+----+---------+--------+----+-----+\n|country|            region|population|area_sq_mi|pop_density_per_sq_mi|coastline_coast_area_ratio|net_migration|infant_mortality_per_1000_births|gdp_per_capita|literacy|phones_per_1000|arable|crops|other|climate|birthrate|deathrate|agriculture|industry|service|code|continent|currency|iso3|phone|\n+-------+------------------+----------+----------+---------------------+--------------------------+-------------+--------------------------------+--------------+--------+---------------+------+-----+-----+-------+---------+---------+-----------+--------+-------+----+---------+--------+----+-----+\n|   Chad|SUB-SAHARAN AFRICA|   9944201|   1284000|                  7.7|                      0.00|        -0,11|                           93.82|          1200|    47.5|            1.3|  2.86| 0.02|97.12|      2|    45.73|    16.38|      0.335|   0.259| 0.406 |  TD|       AF|     XAF| TCD|  235|\n+-------+------------------+----------+----------+---------------------+--------------------------+-------------+--------------------------------+--------------+--------+---------------+------+-----+-----+-------+---------+---------+-----------+--------+-------+----+---------+--------+----+-----+\nonly showing top 1 row\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://adh-client:4041/jobs/job?id=43","http://adh-client:4041/jobs/job?id=44","http://adh-client:4041/jobs/job?id=45","http://adh-client:4041/jobs/job?id=46","http://adh-client:4041/jobs/job?id=47","http://adh-client:4041/jobs/job?id=48","http://adh-client:4041/jobs/job?id=49","http://adh-client:4041/jobs/job?id=50","http://adh-client:4041/jobs/job?id=51"],"interpreterSettingId":"spark"}}},{"text":"%md\n## Save to Hadoop","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:19:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721954094_1836017246","id":"20200714-101914_1061289529","dateCreated":"2020-07-14T10:19:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7332","dateFinished":"2020-07-14T10:19:47+0000","dateStarted":"2020-07-14T10:19:47+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Save to Hadoop</h2>\n</div>"}]}},{"text":"%hive\ncreate database pigidser_datamart;","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:24:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594722273376_579238686","id":"20200714-102433_1163809289","dateCreated":"2020-07-14T10:24:33+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7422"},{"text":"%spark.pyspark\n\nnobel_prizes.write.format(\"orc\") \\\n    .mode('overwrite') \\\n    .option(\"compression\",\"snappy\") \\\n    .saveAsTable(\"pigidser_datamart.nobel_prizes\")\nnobel_laureates.write.format(\"orc\") \\\n    .mode('overwrite') \\\n    .option(\"compression\",\"snappy\") \\\n    .saveAsTable(\"pigidser_datamart.nobel_laureates\")\ncountries.write.format(\"orc\") \\\n    .mode('overwrite') \\\n    .option(\"compression\",\"snappy\") \\\n    .saveAsTable(\"pigidser_datamart.countries\")\ncountries_dataset.write.format(\"orc\") \\\n    .mode('overwrite') \\\n    .option(\"compression\",\"snappy\") \\\n    .saveAsTable(\"pigidser_datamart.countries_dataset\")\nnobel_prizes_dataset.write.format(\"orc\") \\\n    .mode('overwrite') \\\n    .option(\"compression\",\"snappy\") \\\n    .saveAsTable(\"pigidser_datamart.nobel_prizes_dataset\")","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:44:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594721949670_-731647704","id":"20200714-101909_1123232671","dateCreated":"2020-07-14T10:19:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7260","dateFinished":"2020-07-14T10:45:03+0000","dateStarted":"2020-07-14T10:44:39+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://adh-client:4041/jobs/job?id=52","http://adh-client:4041/jobs/job?id=53","http://adh-client:4041/jobs/job?id=54","http://adh-client:4041/jobs/job?id=55","http://adh-client:4041/jobs/job?id=56","http://adh-client:4041/jobs/job?id=57","http://adh-client:4041/jobs/job?id=58","http://adh-client:4041/jobs/job?id=59","http://adh-client:4041/jobs/job?id=60","http://adh-client:4041/jobs/job?id=61","http://adh-client:4041/jobs/job?id=62","http://adh-client:4041/jobs/job?id=63","http://adh-client:4041/jobs/job?id=64","http://adh-client:4041/jobs/job?id=65","http://adh-client:4041/jobs/job?id=66","http://adh-client:4041/jobs/job?id=67"],"interpreterSettingId":"spark"}}},{"text":"%sh\nrm -r -f /tmp/pigidser_raw\nrm -r -f /tmp/pigidser_stage\nhdfs dfs -rm -r -f -skipTrash pigidser_datamart\n","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:49:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594723374980_-617824887","id":"20200714-104254_1127467954","dateCreated":"2020-07-14T10:42:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8292","dateFinished":"2020-07-14T10:49:23+0000","dateStarted":"2020-07-14T10:49:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nDeleted pigidser_datamart\n"}]}},{"text":"%hive\nselect * from pigidser_datamart.nobel_prizes limit 3;","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:49:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"nobel_prizes.year":"string","nobel_prizes.prize":"string","nobel_prizes.motivation":"string","nobel_prizes.prize_share":"string","nobel_prizes.laureate_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"nobel_prizes.year":"string","nobel_prizes.prize":"string","nobel_prizes.motivation":"string","nobel_prizes.prize_share":"string","nobel_prizes.laureate_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594720950693_1049915501","id":"20200714-100230_1333375446","dateCreated":"2020-07-14T10:02:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5652","dateFinished":"2020-07-14T10:49:27+0000","dateStarted":"2020-07-14T10:49:27+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"nobel_prizes.year\tnobel_prizes.prize\tnobel_prizes.motivation\tnobel_prizes.prize_share\tnobel_prizes.laureate_id\n1901\tThe Nobel Prize in Chemistry 1901\tin recognition of the extraordinary services he has rendered by the discovery of the laws of chemical dynamics and osmotic pressure in solutions\t1/1\t160\n1901\tThe Nobel Prize in Literature 1901\tin special recognition of his poetic composition, which gives evidence of lofty idealism, artistic perfection and a rare combination of the qualities of both heart and intellect\t1/1\t569\n1901\tThe Nobel Prize in Physiology or Medicine 1901\tfor his work on serum therapy, especially its application against diphtheria, by which he has opened a new road in the domain of medical science and thereby placed in the hands of the physician a victorious weapon against illness and deaths\t1/1\t293\n"}]}},{"text":"%spark.pyspark\nspark.stop()","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:49:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1594300023875_-1942702949","id":"20200709-130703_1805873241","dateCreated":"2020-07-09T13:07:03+0000","dateStarted":"2020-07-14T10:49:37+0000","dateFinished":"2020-07-14T10:49:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1455"},{"text":"%spark.pyspark\n","user":"pigidser@gmail.com","dateUpdated":"2020-07-14T10:49:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594723777764_-1019754770","id":"20200714-104937_1449137419","dateCreated":"2020-07-14T10:49:37+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11632"}],"name":"/pigidser/project_step4","id":"2FCAPYA38","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"mysql:shared_process":[],"sh:shared_process":[],"spark:pigidser@gmail.com:":[],"hive:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}